<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>My Hostel Store</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

<style>
body{margin:0;font-family:Arial;background:#f2f2f2;}
header{background:#111;color:white;text-align:center;padding:15px;font-size:22px;}
.container{display:grid;grid-template-columns:repeat(auto-fit,minmax(170px,1fr));gap:15px;padding:15px;}
.card{background:white;padding:10px;border-radius:10px;text-align:center;box-shadow:0 4px 10px rgba(0,0,0,0.1);}
.card img{width:100%;height:140px;object-fit:cover;border-radius:8px;}
.price{font-weight:bold;margin:6px;}
.stock{font-size:14px;margin-bottom:5px;}
.btn{background:#25D366;color:white;padding:8px 12px;border:none;border-radius:6px;cursor:pointer;margin-top:5px;}
.infoBar{background:#e2f0ff;padding:6px;text-align:center;}
</style>

</head>

<body>

<header>üõí My Hostel Store</header>
<div id="storeStatus" style="text-align:center;padding:6px;background:#d4edda;color:#155724;">STORE OPEN</div>
<div id="topItem" class="infoBar">Top Item: -</div>

<h2 style="text-align:center">Customer Details</h2>
<div style="text-align:center;margin-bottom:20px;">
<input id="custName" placeholder="Your Name"><br>
<input id="roomNo" placeholder="Room Number"><br>

<select id="hostel">
<option>Boys Hostel</option>
<option>Gate Pickup</option>
<option>Girls Hostel</option>
</select><br>

<select id="payment">
<option>UPI</option>
<option>Cash</option>
<option>Paytm</option>
</select><br>

<input id="utr" placeholder="UPI Ref No"><br>

<select id="mode">
<option value="delivery">Room Delivery</option>
<option value="pickup">Self Pickup</option>
</select><br>
</div>

<div class="container">
<div class="card"><img src="maggi.jpg"><h3>Maggi</h3><div class="price">‚Çπ20</div><div class="stock"></div><input type="number" id="qty1" value="1"><br><button class="btn" onclick="addToCart('Maggi',20,'qty1')">Add</button></div>
<div class="card"><img src="kurkure.jpg"><h3>Kurkure</h3><div class="price">‚Çπ20</div><div class="stock"></div><input type="number" id="qty2" value="1"><br><button class="btn" onclick="addToCart('Kurkure',20,'qty2')">Add</button></div>
<div class="card"><img src="bhujia.jpg"><h3>Bhujia</h3><div class="price">‚Çπ300</div><div class="stock"></div><input type="number" id="qty3" value="1"><br><button class="btn" onclick="addToCart('Bhujia',300,'qty3')">Add</button></div>
<div class="card"><img src="ariel.jpg"><h3>Ariel</h3><div class="price">‚Çπ160</div><div class="stock"></div><input type="number" id="qty4" value="1"><br><button class="btn" onclick="addToCart('Ariel',160,'qty4')">Add</button></div>
</div>

<h2 style="text-align:center">üõí Cart</h2>
<div id="cart" style="text-align:center"></div>

<div style="text-align:center;margin:20px;">
<button class="btn" onclick="placeOrder()">Place Order on WhatsApp</button>
</div>

<!-- ADMIN -->

<div style="text-align:center;margin-top:30px;">
<button onclick="showAdmin()">Admin</button>
<div id="adminPanel" style="display:none;border:1px solid #ccc;padding:10px;margin-top:10px;">
<h3>Admin</h3>
<div id="earningsBox">Today Earnings: ‚Çπ0</div>
<div id="lowStockBox">Low Stock: None</div>
<div id="ordersList"></div>

Maggi <input id="sMaggi" type="number"><br>
Kurkure <input id="sKurkure" type="number"><br>
Bhujia <input id="sBhujia" type="number"><br>
Ariel <input id="sAriel" type="number"><br>

<button onclick="saveStock()">Save Stock</button> <button onclick="resetStock()">Reset</button> <button onclick="toggleStore()">Open/Close</button>

</div>
</div>

<audio id="ding" src="https://www.soundjay.com/buttons/sounds/button-3.mp3"></audio>

<script>
var phone="919983729301";
var cart=[];
var orderCounter=parseInt(localStorage.getItem("orderNo")||1001);
var stockData=JSON.parse(localStorage.getItem("storeStock"))||{Maggi:24,Kurkure:9,Bhujia:2,Ariel:1};

/* ---------- STORE STATUS ---------- */
function updateStoreStatus(){
let closed=localStorage.getItem("storeClosed")==="true";
let bar=document.getElementById("storeStatus");
bar.innerText=closed?"STORE CLOSED":"STORE OPEN";
bar.style.background=closed?"#f8d7da":"#d4edda";
bar.style.color=closed?"#721c24":"#155724";
}
updateStoreStatus();

/* ---------- STOCK DISPLAY ---------- */
function updateStockDisplay(){
document.querySelectorAll(".card").forEach(card=>{
let name=card.querySelector("h3").innerText;
let stock=stockData[name]||0;
let btn=card.querySelector("button");
card.querySelector(".stock").innerText=stock>0?"In Stock: "+stock:"Out of Stock";
btn.disabled=stock<=0;
});
checkLowStock();
}
updateStockDisplay();

/* ---------- ADD TO CART ---------- */
function addToCart(name,price,id){
let q=parseInt(document.getElementById(id).value);
if(q<=0||isNaN(q))return alert("Enter valid quantity");

let already=0;
cart.forEach(i=>{if(i.name===name)already+=i.qty});
let available=stockData[name]-already;
if(q>available)return alert("Only "+available+" left");

let found=cart.find(i=>i.name===name);
if(found)found.qty+=q; else cart.push({name,price,qty:q});
showCart();
}

function showCart(){
let html="",t=0;
cart.forEach((i,x)=>{let s=i.price*i.qty;t+=s;html+=`${i.name} x${i.qty}=‚Çπ${s} <button onclick="removeItem(${x})">‚ùå</button><br>`});
html+="<b>Total ‚Çπ"+t+"</b>";
document.getElementById("cart").innerHTML=html;
}
function removeItem(i){cart.splice(i,1);showCart();}

/* ---------- DELIVERY CHARGE ---------- */
function getDeliveryCharge(mode){
if(mode==="pickup")return 0;
let h=new Date().getHours();
return (h>=8&&h<19)?10:20;
}

/* ---------- PLACE ORDER ---------- */
function placeOrder(){
if(localStorage.getItem("storeClosed")==="true")return alert("Store Closed");
if(cart.length==0)return alert("Cart empty");

let name=custName.value.trim();
let room=roomNo.value.trim();
let hostel=document.getElementById("hostel").value;

let pay=payment.value;
let utr=document.getElementById("utr").value.trim();
let mode=document.getElementById("mode").value;

/* validation */
if(!/^[A-Za-z ]+$/.test(name))return alert("Invalid name");
if(!/^[0-9]+$/.test(room))return alert("Room must be number");
if(hostel==="Girls Hostel")return alert("Not available for girls hostel");
if(pay!=="Cash"&&!/^[0-9]{4,12}$/.test(utr))return alert("Invalid UPI ref");

let cancelCode="CANCEL "+orderCounter;
let total=0,msg=`üßæ ORDER%0AüÜî ${orderCounter}%0A‚ùå ${cancelCode}%0Aüë§ ${name}%0Aüè† ${room}%0Aüè¢ ${hostel}%0Aüì¶ ${mode}%0A%0A`;

cart.forEach(i=>{let s=i.price*i.qty;total+=s;msg+=`‚Ä¢ ${i.name} x${i.qty}=‚Çπ${s}%0A`;stockData[i.name]-=i.qty});
let d=getDeliveryCharge(mode); total+=d;
if(mode==="pickup")msg+=`üìç Collect From Room: 605%0A`;
msg+=`üöö ‚Çπ${d}%0Aüí∞ ‚Çπ${total}%0A`;

localStorage.setItem("storeStock",JSON.stringify(stockData));
localStorage.setItem("orderNo",++orderCounter);
window.open(`https://wa.me/${phone}?text=${msg}`);
cart=[];showCart();updateStockDisplay();
}

/* ---------- ADMIN ---------- */
function showAdmin(){if(prompt("Password")==="291"){adminPanel.style.display="block"}}
function saveStock(){stockData={Maggi:+sMaggi.value,Kurkure:+sKurkure.value,Bhujia:+sBhujia.value,Ariel:+sAriel.value};localStorage.setItem("storeStock",JSON.stringify(stockData));updateStockDisplay();}
function resetStock(){localStorage.removeItem("storeStock");location.reload();}
function toggleStore(){let c=localStorage.getItem("storeClosed")==="true";localStorage.setItem("storeClosed",!c);updateStoreStatus();}

/* ---------- LOW STOCK ---------- */
function checkLowStock(){
let w=[];
for(let k in stockData)if(stockData[k]<=5)w.push(k+"("+stockData[k]+")");
lowStockBox.innerText=w.length?"Low Stock: "+w.join(", "):"Low Stock: None";
}
</script>

</body>
</html>











